select quantities.product, sum(quantities.quantity) from prices
inner join quantities on (prices.product = quantities.product)
inner join othertable on (quantities.product = othertable.product)
inner join osecondtable on (othertable.product = osecondtable.product)
where ((quantities.quantity > 10 and quantities.price > 30) or quantities.quantity = 0)
group by (quantities.product)